# Проект 7. Возьмёте Бэтмобиль?   
##  Юнит 9. Профориентация в Data Science 


### Описание проекта  
За последние несколько месяцев работы в компании «Старый друг», которая занимается продажей автомобилей с пробегом в Москве, вы разработали две модели, которые уже успешно крутятся в продакшне и приносят деньги компании и радость сотрудникам (по словам Анны из отдела продаж).

Осталось довести свою работу до логичного завершения и, обогатив датасет текстовыми данными из объявлений о продаже, свести все наши модели в единое решение — Multi-inputs сеть.  

***Чем мы будем заниматься?***  

- Построим «наивную» ML-модель на табличных данных, которая предсказывает цену по модели и году выпуска. Это позволит нам задать направление для дальнейших экспериментов. Впоследствии, на этом этапе, вы можете доработать вашу модель из проекта «Выбираем авто выгодно».  
- Обработаем и отнормируем признаки и сделаем первую модель на основе градиентного бустинга с помощью CatBoost.
- Решим эту же задачу с помощью DL (модель NN Tabular) и сравним результаты.
- Добавим текстовые данные (NLP) и сделаем Multi-Input нейронную сеть для анализа и табличных данных, и текста одновременно.
- Добавим обработку изображений в Multi-Input нейронную сеть.
- Осуществим ансамблирование градиентного бустинга и нейронной сети (усредним их предсказания).  

### Какой кейс решаем?
Продолжение соревнования на Прогнозирование стоимости автомобиля, но уже с дополнительными данными.

Вам поставлена задача создать модель, которая будет предсказывать стоимость автомобиля.
Если наша модель работает хорошо, то мы сможем быстро выявлять выгодные предложения (когда желаемая цена продавца ниже предсказанной рыночной цены). Это значительно ускорит работу менеджеров и повысит прибыль компании.  

**Условия соревнования:**  
[Ссылка на закрытое соревнование](https://www.kaggle.com/c/sf-dst-car-price-prediction-part2)  

- Данное соревнование является бессрочным и доступно для всех потоков.
- Разрешено использовать любые ML и DL алгоритмы и библиотеки.

### Краткая информация о данных

- train.csv - тренировочный датасет
- test.csv - тестовый датасет
- sample_submission.csv - пример правильного формата submission file
- img.zip - архив базы фотографий авто  

### Этапы работы над проектом  

- провела EDA (очиcтила датасет от выбросов,сгенерила новые признаки и отобрала удачные для построения модели, выполнила нормализацию и стандартизацию некоторых признаков, применила методы для кодирования категориальных признаков).
- построим "наивную" ML-модель на табличных данных.
- потом создала модель на основе градиентного бустинга с помощью CatBoost.
- решила задачу с помощью DL (модель NN Tabular)
- построила модель по обработке естественного языка (NLP) (сначала применила стандартные архитектуры, потом Transfer-Learning и Fine-Tuning, дополнительные методы предобработки текста - лемматизация).
- добавила текстовые данные (NLP) и сделала Multi-Input нейронную сеть для анализа и табличных данных, и текста одновременно
- добавила изображения в Multi-Input нейронную сеть, но это не дало прироста (использовал EfficientNetB3, LR-Cycle) , применила дополнительный метод предобработки изображений - аугментацию.
- применила метод проброса критерия, но прироста это не дало
- применила ансамблирование градиентного бустинга и нейронной сети - этот метод дал результат получше

### Результаты:  
- score на kaggle = 12.79053 
- проект выполнен в двух ноутбуках:
  - ноутбук с EDA и препроцессингом табличных данных. Результатом этого ноутбука является датасет, который используется вторым (основным) ноутбуком.
  - ноутбук основной с построением моделей на табличных данных, препроцессингом изображений и Multi-Input нейронной сетью 


К сожалению не хватило времени, чтобы:
- грамотно оформить основной ноутбук с моделями
- проанализировать, где модель совершает ошибки
- вручную собрать тест, чтобы иметь возможность учесть гибриды и электрокары или отдельно обучить на них модели и сделать блендинг
- посмотреть разные варианты комбинаций признаков для оптимального набора для catboost  
